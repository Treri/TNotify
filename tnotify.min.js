/*!
 * TNotify, ios7+ style alert confirm and prompt service for angular
 * Author: Treri
 * License: MIT
 * Version: 1.0.4
 */
angular.module("TNotify",[]).directive("tNotify",function(){return{restrict:"E",replace:!0,scope:!0,template:'<div class="tnotify-overlay"><div class="tnotify"><div class="tnotify-inner" ng-class="{remind: type === \'remind\'}"><div class="tnotify-title" ng-if="title">{{ title }}</div><div class="tnotify-text" ng-if="text" ng-bind-html="renderHtml(text)"></div><input type="{{ inputType }}" placeholder="{{ inputPlaceHolder }}" class="tnotify-text-input" ng-if="type === \'prompt\'" ng-model="form.input"></div><div class="tnotify-buttons" ng-if="type !== \'remind\'"><span class="tnotify-button" ng-if="type !== \'alert\'" ng-click="onCancel()">{{ cancelText }}</span><span class="tnotify-button tnotify-button-bold" ng-click="onOk(input)">{{ okText }}</span></div></div></div>'}}).factory("transition",["$window",function(t){var n=t.document.createElement("div"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},e={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"},o=function(t){for(var i in t)if(void 0!==n.style[i])return t[i]};return{transitionEndEventName:o(i),animationEndEventName:o(e)}}]).provider("TNotify",function(){var t={title:null,text:null,form:{input:""},inputType:"text",inputPlaceHolder:"",cancelText:"取消",okText:"确定"},n=["title","text","cancelText","okText","inputType","inputPlaceHolder"];this.set=function(i,e){var o=this;if(angular.isObject(i))for(var r in i)o.set(r,i[r]);else i&&n.indexOf(i)>-1&&e&&(t[i]=e)},this.$get=["$sce","$rootScope","$compile","$animate","$q","$document","$timeout","transition",function(n,i,e,o,r,a,s,l){function d(d){var u,c,f,p="tnotify-in",m="tnotify-out",y="tnotify-animate",v="tnotifyEnd";return u=r.defer(),l.transitionEndEventName=l.transitionEndEventName||v,c=i.$new(!0),angular.extend(c,t,d),f=e("<t-notify></t-notify>")(c),c.renderHtml=function(t){return n.trustAsHtml(t)},c.onCancel=function(){"confirm"===c.type?u.resolve(!1):"prompt"===c.type&&(u.resolve(null),c.form.input=""),c.$destroy()},c.onOk=function(){"prompt"===c.type?(u.resolve(c.form.input||""),c.form.input=""):u.resolve(!0),c.$destroy()},o.enter(f,angular.element(a[0].body),angular.element(a[0].body.lastChild)).then(function(){c.$on("$destroy",function(){f.one(l.transitionEndEventName,function(){f.remove()}),f.addClass(m),l.transitionEndEventName===v&&f.triggerHandler(v)}),f.addClass(y).addClass(p),"remind"===c.type&&(l.transitionEndEventName===v?s(c.onOk,650):f.one(l.transitionEndEventName,function(){s(c.onOk,250)}))}),u.promise}function u(t){if(angular.isString(t))return{text:t};if(angular.isObject(t))return t;throw new Error("expect a string or a object")}function c(t){return t=u(t),t.type="alert",d(t)}function f(t){return t=u(t),t.type="confirm",d(t)}function p(t){return t=u(t),t.type="prompt",d(t)}function m(t){return t=u(t),t.type="remind",d(t)}return{alert:c,confirm:f,prompt:p,remind:m}}]});